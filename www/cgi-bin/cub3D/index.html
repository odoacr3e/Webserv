<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>cub3D HUD • Capitano Edition</title>

<style>
    /* ... (Er CSS rimane quello tuo, che è già gajardo) ... */
    body { margin: 0; background: #0b0f12; font-family: monospace; color: #c7d5e0; display: flex; justify-content: center; align-items: center; height: 100vh; }
    .game-wrapper { display: grid; grid-template-columns: 120px auto 120px; grid-template-rows: auto 80px; gap: 20px; align-items: center; }
    .screen-container { grid-column: 2; grid-row: 1; padding: 10px; background: linear-gradient(145deg, #1a2228, #0d1318); border: 4px solid #2a3942; box-shadow: 0 0 25px #000; }
    #screen { display: block; width: 640px; height: 480px; image-rendering: pixelated; background: #000; }
    .controls-left, .controls-right { display: flex; flex-direction: column; gap: 12px; }
    .controls-bottom { grid-column: 2; grid-row: 2; display: flex; justify-content: center; gap: 20px; }
    button { background: #1a2228; border: 2px solid #2a3942; color: #c7d5e0; padding: 10px 12px; cursor: pointer; font-size: 14px; transition: 0.1s; }
    button:hover { background: #2a3942; box-shadow: 0 0 8px #00ffcc; }
    .label { font-size: 12px; text-align: center; opacity: 0.6; }
</style>
</head>

<body>

<div class="game-wrapper">
    <div class="controls-left">
        <button onclick="sendInput('x')">X<br><span class="label">Restart</span></button>
    </div>

    <div class="screen-container">
        <img id="screen" src="cub3D.cgi?www/cgi-bin/cub3D/srcs/maps/debug.cub" alt="Cub3D Render">
    </div>

    <div class="controls-right">
        <button onclick="sendInput('w')">W</button>
        <button onclick="sendInput('a')">A</button>
        <button onclick="sendInput('d')">D</button>
        <button onclick="sendInput('s')">S</button>
        <button onclick="sendInput(' ')">Enter</button>
    </div>

    <div class="controls-bottom">
        <button onclick="sendInput('1')">1<br><span class="label">Sasso</span></button>
        <button onclick="sendInput('2')">2<br><span class="label">Carta</span></button>
        <button onclick="sendInput('3')">3<br><span class="label">Forbici</span></button>
        <button onclick="sendInput('4')">4<br><span class="label">Cerchio</span></button>
    </div>
</div>

<script>
const FPS = 15; // Alzamo un po' er ritmo?
const screenImg = document.getElementById("screen");
const cgiPath = "cub3D.cgi"; // Metti er percorso giusto der tuo eseguibile C++

// Questa funzione aggiorna l'immagine chiedendo er BMP con comando \0
function refreshFrame() {
    // Aggiungiamo un timestamp per evità che er browser faccia er pigro (Cache Busting)
    const timestamp = new Date().getTime();
    screenImg.src = cgiPath + "?-" + action + "-";
	action = 0;
}

// Gestione input: manda er comando e aggiorna subito l'immagine col risultato
function sendInput(action) {
    console.log("Invio comando:", action);
    const timestamp = new Date().getTime();
    
    // Mandiamo l'input. Il server deve risponne co l'header "Content-Type: image/bmp"
    // e er corpo del file .bmp
    screenImg.src = cgiPath + "?-" + action + "-";
}

// Loop principale: se nun premi gnente, lui continua a chiede frame con \0
setInterval(() => {
    // Se vòi che l'immagine se aggiorni da sola stile video:
    refreshFrame();
}, 1000 / FPS);

</script>
</body>
</html>